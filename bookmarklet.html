<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºBookmarklet - Race DB App</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background-color: #f8f9fa;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #007bff;
      text-align: center;
      margin-bottom: 30px;
      font-size: 28px;
    }
    h2 {
      color: #495057;
      border-bottom: 2px solid #007bff;
      padding-bottom: 8px;
      margin-top: 30px;
    }
    .bookmarklet {
      background-color: #e8f4fd;
      border: 2px solid #007bff;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    .bookmarklet-link {
      display: inline-block;
      background-color: #007bff;
      color: white;
      padding: 15px 30px;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      font-size: 16px;
      cursor: grab;
      transition: background-color 0.3s;
    }
    .bookmarklet-link:hover {
      background-color: #0056b3;
    }
    .step {
      background-color: #f8f9fa;
      border-left: 4px solid #28a745;
      padding: 15px;
      margin: 15px 0;
      border-radius: 0 8px 8px 0;
    }
    .step h3 {
      margin-top: 0;
      color: #28a745;
    }
    .warning {
      background-color: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
    }
    .warning h3 {
      color: #856404;
      margin-top: 0;
    }
    .code {
      background-color: #f1f3f4;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      padding: 15px;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 12px;
      overflow-x: auto;
      margin: 15px 0;
    }
    .back-link {
      text-align: center;
      margin-top: 30px;
    }
    .back-link a {
      color: #007bff;
      text-decoration: none;
      font-weight: bold;
    }
    .back-link a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”– ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºBookmarklet</h1>
    
    <p>netkeibaã®ãƒ¬ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã‹ã‚‰ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã‚’ç°¡å˜ã«æŠ½å‡ºã§ãã‚‹Bookmarkletã§ã™ã€‚<br>
    ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã«ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦è¨­ç½®ã—ã¦ãã ã•ã„ã€‚</p>

    <div class="warning">
      <h3>âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …</h3>
      <ul>
        <li><strong>å€‹äººåˆ©ç”¨ãƒ»ç ”ç©¶ç”¨é€”ã«é™å®š</strong>ã—ã¦ãã ã•ã„</li>
        <li><strong>å•†ç”¨åˆ©ç”¨ã¯ç¦æ­¢</strong>ã•ã‚Œã¦ã„ã¾ã™</li>
        <li>éåº¦ãªé€£ç¶šå®Ÿè¡Œã¯é¿ã‘ã€<strong>é©åº¦ãªé–“éš”</strong>ã‚’é–‹ã‘ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„</li>
        <li>netkeibaã®åˆ©ç”¨è¦ç´„ã‚’éµå®ˆã—ã¦ãã ã•ã„</li>
      </ul>
    </div>

    <h2>ğŸ“¥ Bookmarkletè¨­ç½®</h2>
    
    <div class="bookmarklet">
      <p><strong>ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã«ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„</strong></p>
      <a href="javascript:(function(){try{const r=document.querySelector('.RaceName')?.textContent?.trim()||'',a=document.querySelector('.RaceData01')?.textContent?.trim()||'',t=document.querySelector('.RaceData02')?.textContent?.trim()||'',e=[];document.querySelectorAll('.Shutuba_Table tbody tr').forEach(r=>{const a=r.querySelectorAll('td');if(a.length>=11){const r=parseInt(a[0]?.textContent?.trim())||0,t=parseInt(a[1]?.textContent?.trim())||0,o=a[3]?.querySelector('a')?.textContent?.trim()||a[3]?.textContent?.trim()||'',n=a[4]?.textContent?.trim()||'',s=parseFloat(a[5]?.textContent?.trim())||0,c=a[6]?.querySelector('a')?.textContent?.trim()||a[6]?.textContent?.trim()||'';if(o){const d=document.getElementById(`odds-1_${t.toString().padStart(2,'0')}`),l=document.getElementById(`ninki-1_${t.toString().padStart(2,'0')}`),i=d?parseFloat(d.textContent.trim())||0:0,u=l?parseInt(l.textContent.trim())||0:0;e.push({frameNumber:r,horseNumber:t,name:o,sex:n.match(/([ç‰¡ç‰ã‚»])/)?.[1]||'',age:parseInt(n.match(/(\d+)/)?.[1])||0,weight:s,jockey:c,odds:i,popularity:u})}}});const o={raceTitle:r,raceData01:a,raceData02:t,horses:e};navigator.clipboard.writeText(JSON.stringify(o)).then(()=>{alert(`ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã—ãŸï¼\nãƒ¬ãƒ¼ã‚¹: ${r}\né¦¬æ•°: ${e.length}é ­\n\nã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ãŸã®ã§ã€ã‚¢ãƒ—ãƒªã§è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚`)})}catch(r){alert('ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã«å¤±æ•—ã—ã¾ã—ãŸ: '+r.message)}})();" 
           class="bookmarklet-link">
        ğŸ‡ netkeibaãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆå®Œå…¨ç‰ˆï¼‰
      </a>
      
      <br><br>
      
      <!-- ã‚ªãƒƒã‚ºèª¿æŸ»ç‰ˆBookmarklet -->
      <a href="javascript:console.log('ğŸ”ã‚ªãƒƒã‚ºèª¿æŸ»é–‹å§‹');const odds=document.querySelectorAll('[id*=odds]');const pop=document.querySelectorAll('[id*=ninki]');console.log('ã‚ªãƒƒã‚ºè¦ç´ :',odds.length+'å€‹');odds.forEach((e,i)=>console.log(i+':',e.id,e.textContent.trim()));console.log('äººæ°—è¦ç´ :',pop.length+'å€‹');pop.forEach((e,i)=>console.log(i+':',e.id,e.textContent.trim()));alert('èª¿æŸ»å®Œäº†ï¼ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç¢ºèª');" 
           class="bookmarklet-link" style="background-color: #ffc107; color: black;">
        ğŸ” ã‚ªãƒƒã‚ºèª¿æŸ»ç‰ˆï¼ˆè©³ç´°åˆ†æï¼‰
      </a>
    </div>

    <h2>ğŸ“‹ ä½¿ç”¨æ–¹æ³•</h2>
    
    <div class="step">
      <h3>ã‚¹ãƒ†ãƒƒãƒ— 1: Bookmarkletè¨­ç½®</h3>
      <p>ä¸Šã®ãƒªãƒ³ã‚¯ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã«ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <div class="step">
      <h3>ã‚¹ãƒ†ãƒƒãƒ— 2: netkeibaãƒšãƒ¼ã‚¸ã‚’é–‹ã</h3>
      <p>netkeibaã®ãƒ¬ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ï¼ˆå‡ºé¦¬è¡¨ãƒšãƒ¼ã‚¸ï¼‰ã‚’é–‹ã„ã¦ãã ã•ã„ã€‚<br>
      ä¾‹: <code>https://race.netkeiba.com/race/shutuba.html?race_id=...</code></p>
    </div>

    <div class="step">
      <h3>ã‚¹ãƒ†ãƒƒãƒ— 3: Bookmarkletå®Ÿè¡Œ</h3>
      <p>ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã®ã€ŒğŸ‡ netkeibaãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚<br>
      ãƒ‡ãƒ¼ã‚¿ãŒæŠ½å‡ºã•ã‚Œã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã™ã€‚</p>
    </div>

    <div class="step">
      <h3>ã‚¹ãƒ†ãƒƒãƒ— 4: ã‚¢ãƒ—ãƒªã§è²¼ã‚Šä»˜ã‘</h3>
      <p>Race DB Appã®ã€ŒBookmarklet ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«JSONãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ã€<br>
      ã€ŒğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <h2>ğŸ”§ æŠ€è¡“è©³ç´°</h2>
    
    <p>Bookmarkletã¯ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã™ï¼š</p>
    <ul>
      <li><strong>ãƒ¬ãƒ¼ã‚¹æƒ…å ±</strong>: ãƒ¬ãƒ¼ã‚¹åã€è·é›¢ã€é¦¬å ´ã€ã‚³ãƒ¼ã‚¹</li>
      <li><strong>é¦¬ãƒ‡ãƒ¼ã‚¿</strong>: æ ç•ªã€é¦¬ç•ªã€é¦¬åã€æ€§åˆ¥ã€å¹´é½¢ã€æ–¤é‡ã€é¨æ‰‹</li>
    </ul>

    <details>
      <summary><strong>Bookmarkletã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆå‚è€ƒï¼‰</strong></summary>
      <div class="code">
javascript:(function(){
  try {
    // ãƒ¬ãƒ¼ã‚¹åŸºæœ¬æƒ…å ±ã‚’æŠ½å‡º
    const raceTitle = document.querySelector('.RaceName')?.textContent?.trim() || '';
    const raceData01 = document.querySelector('.RaceData01')?.textContent?.trim() || '';
    const raceData02 = document.querySelector('.RaceData02')?.textContent?.trim() || '';
    
    // é¦¬ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
    const horses = [];
    document.querySelectorAll('.Shutuba_Table tbody tr').forEach(row => {
      const cells = row.querySelectorAll('td');
      if (cells.length >= 11) {
        const frameNumber = parseInt(cells[0]?.textContent?.trim()) || 0;
        const horseNumber = parseInt(cells[1]?.textContent?.trim()) || 0;
        const horseName = cells[3]?.querySelector('a')?.textContent?.trim() || 
                         cells[3]?.textContent?.trim() || '';
        const sexAge = cells[4]?.textContent?.trim() || '';
        const weight = parseFloat(cells[5]?.textContent?.trim()) || 0;
        const jockey = cells[6]?.querySelector('a')?.textContent?.trim() || 
                      cells[6]?.textContent?.trim() || '';
        
        if (horseName) {
          horses.push({
            frameNumber, horseNumber, name: horseName,
            sex: sexAge.match(/([ç‰¡ç‰ã‚»])/)?.[1] || '',
            age: parseInt(sexAge.match(/(\d+)/)?.[1]) || 0,
            weight, jockey, odds: 0, popularity: 0
          });
        }
      }
    });
    
    // ãƒ‡ãƒ¼ã‚¿ã‚’JSONã«å¤‰æ›ã—ã¦ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
    const data = { raceTitle, raceData01, raceData02, horses };
    navigator.clipboard.writeText(JSON.stringify(data)).then(() => {
      alert(`ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã—ãŸï¼\nãƒ¬ãƒ¼ã‚¹: ${raceTitle}\né¦¬æ•°: ${horses.length}é ­\n\nã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ãŸã®ã§ã€ã‚¢ãƒ—ãƒªã§è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚`);
    });
    
  } catch (error) {
    alert('ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
  }
})();
      </div>
    </details>

    <h2>ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
    
    <h3>ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã„å ´åˆ</h3>
    <ul>
      <li>netkeibaã®å‡ºé¦¬è¡¨ãƒšãƒ¼ã‚¸ã§å®Ÿè¡Œã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
      <li>ãƒšãƒ¼ã‚¸ãŒå®Œå…¨ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„</li>
      <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®JavaScriptãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
    </ul>

    <h3>ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œãªã„å ´åˆ</h3>
    <ul>
      <li>ãƒ–ãƒ©ã‚¦ã‚¶ãŒã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
      <li>HTTPSæ¥ç¶šã§å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
    </ul>

    <div class="back-link">
      <a href="/race-db-app/">â† Race DB Appã«æˆ»ã‚‹</a>
    </div>
  </div>
</body>
</html>